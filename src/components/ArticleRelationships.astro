---
import type { PublicArticleRelationships } from "../sdk/types.gen";

interface Props {
  relationships: PublicArticleRelationships;
}

const { relationships } = Astro.props;
---

{
  relationships?.about && relationships.about.length > 0 && (
    <>
      {relationships.about.map((rel) => {
        const entity = Array.isArray(rel.entity) ? rel.entity[0] : rel.entity;
        const attributes = (entity as any)?.attributes;

        if (attributes && Object.keys(attributes).length > 0) {
          return (
            <div class="border border-gray-300 my-5 bg-gray-100 rounded">
              <p class="text-sm uppercase text-gray-700 m-0 border-b border-gray-300 p-4 leading-none">
                Project Discussed
              </p>
              <div class="p-4 bg-gray-50">
                <h2 class="text-2xl font-medium m-0 mb-2">
                  <a
                    href={`/project/${entity.slug}`}
                    class="text-blue-600 hover:underline"
                  >
                    {entity.name}
                  </a>
                </h2>

                {attributes.category && (
                  <div>
                    <p class="text-base text-gray-500 mb-2">
                      {attributes.category}
                    </p>
                  </div>
                )}

                {attributes.description && (
                  <p class="text-gray-600 mb-2">{attributes.description}</p>
                )}
              </div>
            </div>
          );
        }
        return null;
      })}
    </>
  )
}

{
  relationships?.itemReviewed && relationships.itemReviewed.length > 0 && (
    <>
      {relationships.itemReviewed.map((rel) => {
        const entity = Array.isArray(rel.entity) ? rel.entity[0] : rel.entity;
        const attributes = (entity as any)?.attributes;

        if (attributes && Object.keys(attributes).length > 0) {
          return (
            <div class="border border-gray-300 my-5 bg-gray-100 rounded">
              <p class="text-sm uppercase text-gray-700 m-0 border-b border-gray-300 p-4 leading-none">
                Reviewed Project
              </p>
              <div class="p-4 bg-gray-50">
                <h2 class="text-2xl font-medium m-0 mb-2">
                  <a
                    href={`/project/${entity.slug}`}
                    class="text-blue-600 hover:underline"
                  >
                    {entity.name}
                  </a>
                </h2>

                {attributes.category && (
                  <div>
                    <p class="text-base text-gray-500 mb-2">
                      {attributes.category}
                    </p>
                  </div>
                )}

                {attributes.description && (
                  <p class="text-gray-600 mb-2">{attributes.description}</p>
                )}
              </div>
            </div>
          );
        }
        return null;
      })}
    </>
  )
}

{
  relationships?.mentions && relationships.mentions.length > 0 && (
    <>
      {relationships.mentions.map((rel) => {
        const entity = Array.isArray(rel.entity) ? rel.entity[0] : rel.entity;
        const attributes = (entity as any)?.attributes;

        if (attributes && Object.keys(attributes).length > 0) {
          return (
            <div class="border border-gray-300 my-5 bg-gray-100 rounded">
              <p class="text-sm uppercase text-gray-700 m-0 border-b border-gray-300 p-4 leading-none">
                Project Mentioned
              </p>
              <div class="p-4 bg-gray-50">
                <h2 class="text-2xl font-medium m-0 mb-2">
                  <a
                    href={`/project/${entity.slug}`}
                    class="text-blue-600 hover:underline"
                  >
                    {entity.name}
                  </a>
                </h2>

                {attributes.category && (
                  <div>
                    <p class="text-base text-gray-500 mb-2">
                      {attributes.category}
                    </p>
                  </div>
                )}

                {attributes.description && (
                  <p class="text-gray-600 mb-2">{attributes.description}</p>
                )}
              </div>
            </div>
          );
        }
        return null;
      })}
    </>
  )
}
